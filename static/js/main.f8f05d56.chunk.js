(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{213:function(e,t,n){},354:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(32),r=n.n(o),c=(n(213),n(19)),l=n(49),s=n.n(l),d=n(102),u=n(11),j=(n(196),n(16),n(50)),b=n(198),h=n(388),p=n(175),f=(n(140),n.p+"static/media/esc.ece60bb7.png"),v=n(381),m=n(379),w=n(390),x=n(380),O=n(378),g=n(389),y=n(6);function S(e){var t=e.children,n=e.value,a=e.index,i=Object(b.a)(e,["children","value","index"]);return Object(y.jsx)("div",Object(j.a)(Object(j.a)({role:"tabpanel",hidden:n!==a,id:"vertical-tabpanel-".concat(a),"aria-labelledby":"vertical-tab-".concat(a)},i),{},{children:n===a&&Object(y.jsx)(g.a,{p:3,children:Object(y.jsx)(O.a,{children:t})})}))}function k(e){return{id:"vertical-tab-".concat(e),"aria-controls":"vertical-tabpanel-".concat(e)}}var z=Object(m.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,display:"flex",height:224},tabs:{borderRight:"1px solid ".concat(e.palette.divider)}}})),A=function(e){var t=z(),n=Object(a.useState)(0),i=Object(c.a)(n,2),o=i[0],r=i[1],l=Object(a.useState)({time:!0,xposition:!0,yposition:!0,traction:!1,aflow:!1,modulenum:!1}),s=Object(c.a)(l,2),d=(s[0],s[1],Object(a.useState)(["cell_pos_x","cell_pos_y","time"])),u=Object(c.a)(d,2);u[0],u[1];return Object(y.jsxs)(h.a,Object(j.a)(Object(j.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(y.jsx)(h.a.Header,{children:Object(y.jsx)(h.a.Title,{id:"contained-modal-title-vcenter",children:"Settings"})}),Object(y.jsxs)(h.a.Body,{children:[Object(y.jsxs)("div",{className:t.root,children:[Object(y.jsxs)(w.a,{orientation:"vertical",variant:"scrollable",value:o,onChange:function(e,t){r(t)},"aria-label":"Vertical tabs example",className:t.tabs,children:[Object(y.jsx)(x.a,Object(j.a)({label:"tutorial"},k(0))),Object(y.jsx)(x.a,Object(j.a)({label:"options"},k(1)))]}),Object(y.jsxs)(S,{value:o,index:0,children:[Object(y.jsxs)("ul",{children:[Object(y.jsxs)("li",{style:{paddingBottom:"8px"},children:["You can rotate the visualization by pressing and ",Object(y.jsx)("br",{}),' holding the "\u2190" or "\u2192" key on your keyboard ']}),Object(y.jsxs)("li",{style:{paddingBottom:"8px"},children:["Once you start working on a curve, the other curves ",Object(y.jsx)("br",{}),"will be disabled from being selected"]}),Object(y.jsxs)("li",{children:['To clear the scene, please press "Esc" on your keyboard ',Object(y.jsx)("br",{}),' to open the setting panel and click "CLEAR CANVAS"']})]}),Object(y.jsx)("p",{style:{textAlign:"right",fontSize:"20px"},children:" -- Thanks!"})]}),Object(y.jsxs)(S,{value:o,index:1,children:[Object(y.jsx)("div",{style:{height:"50px"}}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(y.jsx)("div",{style:{width:"122px"}}),Object(y.jsx)(v.a,{variant:"outlined",color:"secondary",style:{},onClick:function(){"false"===window.localStorage.getItem("ifsplit")?window.localStorage.setItem("ifsplit",!0):window.localStorage.setItem("ifsplit",!1),window.location.reload()},children:"switch analysis mode"})]})]})]}),Object(y.jsx)("div",{style:{textAlign:"center"},children:Object(y.jsx)(v.a,{variant:"outlined",color:"secondary",style:{},onClick:function(){fetch("/deleteall"),window.location.reload()},children:"clear canvas"})})]}),Object(y.jsx)(h.a.Footer,{children:Object(y.jsxs)(h.a.Title,{id:"contained-modal-title-vcenter",size:"sm",children:["Press ",Object(y.jsx)(p.a,{src:f,rounded:!0,style:{width:"40px",height:"40px"}})," to close"]})})]}))},C=n(197),E=n(385),I=n(386),F=n(387),L=n(191),P=n(192),_=n(93);var D=function(e){var t,n=[],a=0,i=0;if(e.traction&&e.aflow&&e.modulenum&&e.time){for(var o in e.traction)a+=1;for(var r in e.traction[0])i+=1;for(var c=0;c<a;c++){n.push([]);for(var l=0;l<i;l++)n[c].push({})}for(var s=0;s<a;s++)for(var d=0;d<i;d++)n[s][d]["traction"+String(s)]=e.traction[s][d];for(var u=0;u<a;u++)for(var j=0;j<i;j++)n[u][j]["aflow"+String(u)]=e.aflow[u][j];for(var b=0;b<a;b++)for(var h=0;h<i;h++)n[b][h]["modulenum"+String(b)]=e.modulenum[b][h];for(var p=0;p<a;p++)for(var f=0;f<i;f++)n[p][f].time=e.time[p][f]}function v(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}n.sort((function(e,t){return e[0].time<t[0].time?-1:e[0].time>t[0].time?1:0})),console.log(n),t=function(e){for(var t=[],n=0;n<a;n++)for(var o=0;o<i;o++)t.push(e[n][o]);return t}(n);for(var m=[],w=[[],[],[]],x=0;x<a;x++){var O="traction"+String(x),g="aflow"+String(x),S="modulenum"+String(x),k=v();w[0].push(Object(y.jsx)(C.a,{type:"monotone",dataKey:O,stroke:k,dot:!1})),w[1].push(Object(y.jsx)(C.a,{type:"monotone",dataKey:g,stroke:k,dot:!1})),w[2].push(Object(y.jsx)(C.a,{type:"monotone",dataKey:S,stroke:k,dot:!1}))}for(var z=0;z<3;z++)m.push(Object(y.jsx)(E.a,{width:"90%",height:"33%",children:Object(y.jsxs)(I.a,{data:t,children:[Object(y.jsx)(F.a,{strokeDasharray:"3 3"}),Object(y.jsx)(L.a,{dataKey:"time"}),Object(y.jsx)(P.a,{}),Object(y.jsx)(_.a,{}),w[z]]})}));return Object(y.jsx)("div",{style:{height:"100%",width:"50%",border:"10px solid rgba(0, 0, 0, 0.7)"},children:m})},H=function(e){var t=Object(a.useRef)(null),n=!0,i=!1,o=Object(a.useState)(null),r=Object(c.a)(o,2),l=r[0],j=r[1],b=Object(a.useState)(null),h=Object(c.a)(b,2),p=h[0],f=h[1],v=Object(a.useState)(null),m=Object(c.a)(v,2),w=m[0],x=m[1],O=Object(a.useState)(null),g=Object(c.a)(O,2),S=g[0],k=g[1],z=Object(a.useState)(["cell_pos_x","cell_pos_y","time"]),C=Object(c.a)(z,2),E=C[0];C[1];function I(e){}null===window.localStorage.getItem("feature")&&window.localStorage.setItem("feature",E),Object(a.useEffect)(Object(d.a)(s.a.mark((function e(){var a,o,r,c,l,d,b,h,p,v,m,w,O,g,y,S,z,A,C,E,I,F,L,P,_,D,H,N,T,B,M;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M=function(){w.setFromCamera(C,v);var e=w.intersectObjects(h.children,!0);e.length>0?(g.visible=!1,g.position.copy(e[0].point)):g.visible=!1,O.render(m,v);var t=new u.o(C.x,C.y,.5);t.unproject(v);var n=t.sub(v.position).normalize(),a=-v.position.z/n.z;b=v.position.clone().add(n.multiplyScalar(a)),E>.02&&(A[c].position.copy(b),A[c].scale.set(1,1,1),c=(c+1)%A.length,E=0);for(var i=0;i<A.length;i++){var o=A[i];o.scale.multiplyScalar(.97),o.scale.clampScalar(.01,10)}E+=p.getDelta()},B=function(){requestAnimationFrame(B),M()},T=function(e){if(e.preventDefault(),!n){C.set(e.clientX/I.clientWidth*2-1,-e.clientY/I.clientHeight*2+1),w.setFromCamera(C,v);var t=w.intersectObjects(h.children),i=w.intersectObjects(y.children);if(0==z)if(t.length>0){for(var o=a[t[0].object.name][0].length,r=0;r<20;r++)h.children[r].material.opacity=.22;var c=t[0];c.object.material.opacity=1,M();for(var s=[],b=1;b<o;b++){s.push([]);for(var p=0;p<2;p++){var m=new u.o,O=new u.o;m.x=a[c.object.name][0][b-p],m.z=a[c.object.name][1][b-p],m.y=a[c.object.name][2][b-p],O.add(m),s[b-1].push(O.x,O.y,O.z)}var g=new u.a;g.setAttribute("position",new u.d(s[b-1],3));var A=new u.f({color:16777215*Math.random(),opacity:1,transparent:!0}),E=new u.e(g,A);E.name=String(b-1),y.add(E)}L.add(y),z=!0,d=t[0].object.name,c.object.visible=!1}else{z=!1;for(var F=0;F<20;F++)h.children[F].material.opacity=1}else if(i.length>0){for(var P=a[t[0].object.name][0].length,_=0;_<P-1;_++).9314!=y.children[_].material.opacity&&(y.children[_].material.opacity=.5);var D=i[0];D.object.material.color.setHex(16711680),D.object.material.opacity=.9314,l.add(D.object.name),fetch("/api",{method:"POST",headers:{Accept:"application/json","Content-type":"application/json"},body:JSON.stringify({input:Array.from(l),curveid:d})}).then((function(e){fetch("/result").then((function(e){return e.json()})).then((function(e){console.log(e),L.remove(S),S=new u.i,H(e)}))})).then((function(){"true"===window.localStorage.getItem("ifsplit")&&fetch("/resultplot").then((function(e){return e.json()})).then((function(e){console.log(e),j(e.traction),f(e.aflow),x(e.module_num),k(e.time)}))}))}}},N=function(e){e.preventDefault(),C.x=e.clientX/I.clientWidth*2-1,C.y=-e.clientY/I.clientHeight*2+1},H=function(e){for(var t=0;t<e.results.length;t++)for(var n=e.results[t][0],i=e.results[t][1],o=[],r=n+1;r<=i;r++){o.push([]);for(var c=0;c<2;c++){var l=new u.o,s=new u.o;l.x=a[t][0][r-c],l.z=a[t][1][r-c],l.y=a[t][2][r-c],s.add(l),o[r-1-n].push(s.x,s.y,s.z)}var d=new u.a;d.setAttribute("position",new u.d(o[r-1-n],3));var j=new u.f({color:16711680,opacity:1,transparent:!0}),b=new u.e(d,j);S.add(b)}L.add(S)},D=function(){v.aspect=I.clientWidth/I.clientHeight,v.updateProjectionMatrix(),O.setSize(I.clientWidth,I.clientHeight)},_=function(e){var t=e.which;37==t?L.rotateY(.02):39==t?L.rotateY(-.02):27==e.which&&(n=!n,i=!i,document.body.style.cursor=i?"none":"default")},P=function(){var e=document.createElement("div");e.style.position="absolute",e.style.top="10px",e.style.width="100%",e.style.textAlign="center",(m=new u.l).add(L),L.add(F),F.position.set(0,200,0),(v=new u.j(70,I.clientWidth/I.clientHeight,1,1e4)).position.set(0,200,300),v.lookAt(F.position),p=new u.b,m.background=new u.c(16777215);var t=new u.m(2),n=new u.h({color:16711680});(g=new u.g(t,n)).visible=!1,L.add(g);var i=[];h=new u.i;for(var o=0;o<20;o++){i.push([]);for(var r=0;r<a[0][0].length;r++){var c=new u.o,l=new u.o;c.x=a[o][0][r],c.z=a[o][1][r],c.y=a[o][2][r],l.add(c),i[o].push(l.x,l.y,l.z)}var s=new u.a;s.setAttribute("position",new u.d(i[o],3));var d=new u.f({color:16777215*Math.random(),opacity:1,transparent:!0}),j=new u.e(s,d);j.name=o,h.add(j)}L.add(h),(w=new u.k).params.Line.threshold=3;for(var b=new u.m(3,32,32),f=new u.h({color:16711935,sizeAttenuation:!1}),x=0;x<40;x++){var y=new u.g(b,f);m.add(y),A.push(y)}(O=new u.p({antialias:!0})).setPixelRatio(window.devicePixelRatio),O.setSize(I.clientWidth,I.clientHeight),I.appendChild(O.domElement),window.addEventListener("mousemove",N),window.addEventListener("mousedown",T),window.addEventListener("resize",D),window.addEventListener("keydown",_)},a=null,e.next=11,fetch("/databasepost",{method:"POST",headers:{Accept:"application/json","Content-type":"application/json"},body:JSON.stringify({required:window.localStorage.getItem("feature").split(",")})});case 11:return e.sent,e.next=14,fetch("/databaseget");case 14:return o=e.sent,e.next=17,o.json();case 17:r=e.sent,a=r.result,c=0,l=new Set,new u.o,b=new u.o,y=new u.i,S=new u.i,z=!1,A=[],C=new u.n,100,0,E=0,I=t.current,F=new u.i,0,L=new u.i,P(),B();case 37:case"end":return e.stop()}}),e)}))),[]);var F=Object(a.useState)(!0),L=Object(c.a)(F,2),P=L[0],_=L[1],H=function(e){27===e.keyCode&&_((function(e){return!e}))};return Object(a.useEffect)((function(){return document.addEventListener("keydown",H),function(){document.removeEventListener("keydown",H)}}),[]),"false"===window.localStorage.getItem("ifsplit")?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"mainvisualization",style:{height:"100%",width:"true"===window.localStorage.getItem("ifsplit")?"50%":"100%",border:"10px solid rgba(0, 0, 0, 0.7)"},ref:t}),Object(y.jsx)(A,{show:P,backdrop:"static",changeInput:I})]}):Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"row"},children:[Object(y.jsx)("div",{className:"mainvisualization",style:{height:"100%",width:"true"===window.localStorage.getItem("ifsplit")?"50%":"100%",border:"10px solid rgba(0, 0, 0, 0.7)"},ref:t}),Object(y.jsx)(A,{show:P,backdrop:"static",changeInput:I}),Object(y.jsx)(D,{traction:l,aflow:p,modulenum:w,time:S})]})})},N=i.a.createContext(null);var T=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],i=t[1];return Object(y.jsx)("div",{className:"App",children:Object(y.jsx)(N.Provider,{value:0,children:Object(y.jsx)(H,{ifsuccess:n,onSuccess:function(){return i(!0)}})})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,394)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),o(e),r(e)}))};r.a.render(Object(y.jsx)(i.a.StrictMode,{children:Object(y.jsx)(T,{})}),document.getElementById("root")),B()}},[[354,1,2]]]);
//# sourceMappingURL=main.f8f05d56.chunk.js.map